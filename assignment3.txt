----- Question 1 ----
SELECT PARTICIPATED.name FROM PARTICIPATED
INNER JOIN CLIMBED
	ON CLIMBED.TRIP_ID = PARTICIPATED.TRIP_ID
WHERE CLIMBED.PEAK = 'Pilot Knob (S)'

-- Results
JOHN
MARK
MICHAEL

---- Question 2 ----
SELECT CLIMBED.PEAK FROM PARTICIPATED
INNER JOIN CLIMBED
	on CLIMBED.TRIP_ID = PARTICIPATED.TRIP_ID
WHERE PARTICIPATED.name = 'MARK';

-- Results


---- Question 3 ----
SELECT PARTICIPATED.name FROM PEAK
INNER JOIN CLIMBED
	ON CLIMBED.PEAK = PEAK.NAME
INNER join PARTICIPATED
	ON PARTICIPATED.trip_id = CLIMBED.trip_id
WHERE PEAK.diff = 5;

---- Question 4 ----
SELECT COUNT(*) as numberOfClimbs, CLIMBED.PEAK FROM PARTICIPATED 
INNER JOIN CLIMBED 
	ON CLIMBED.TRIP_ID = PARTICIPATED.TRIP_ID
GROUP BY CLIMBED.PEAK
hAVING COUNT(*) = 1;

---- Question 5 ----
SELECT DISTINCT CLIMBED.peak FROM CLIMBED
inner join PARTICIPATED
	ON PARTICIPATED.trip_id = CLIMBED.trip_id
INNER JOIN PEAK
	ON PEAK.name = CLIMBED.PEAK
WHERE PARTICIPATED.name = "JOHN" AND PEAK.elev >= 14000

---- Question 6 ----
SELECT map, MAX(elev) - MIN(elev) as delta FROM PEAK
grouP BY map
HAVING delta > 2000

---- Question 7 ----
-- Rounded the average height to the nearest integer to cleanliness
SELECT map, ROUND(AVG(elev)) as avgelev FROM PEAK
grouP BY map
ORDER BY avgelev DESC

---- Question 8 ----
SELECT peak from CLIMBED
inner join (
	SELECT trip_id from PARTICIPATED
  	WHERE NAME IN ("MARK", "MARY")
  	group by trip_id
) as pyt
	on pyt.trip_id = CLIMBED.trip_id

---- Question 9 ----
SELECT PEAK.region, COUNT(PEAK.name) - c.peaksClimbed as unclimbedPeaks FROM PEAK
INNER JOIN (
	SELECT COUNT(DISTINCT CLIMBED.peak) as peaksClimbed, peak.region FROM PEAK
	INNER JOIN CLIMBED
		ON CLIMBED.PEAK = PEAK.NAME
	GROUP BY region
) as c
on c.region = PEAK.region
GROUP by PEAK.region

---- Question 10 ----
select CLIMBED.trip_id, SUM(peak.elev) as totalElev from CLIMBED
left JOIN PEAK
	ON peak.name = CLIMBED.PEAK
left join PARTICIPATED
	on PARTICIPATED.trip_id = CLIMBED.trip_id
GROUP by PARTICIPATED.trip_id
HAVING totalElev > 500000
ORDER BY totalElev desc

---- Question 11 ----
select c.peaksClimbed/COUNT(CLIMBER.SEX) as avgClimbs,CLIMBER.sex from CLIMBER
INNER JOIN (
 	select COUNT(CLIMBED.peak) as peaksClimbed,CLIMBER.sex from CLIMBER
	INNER JOIN PARTICIPATED
		ON PARTICIPATED.NAME = CLIMBER.name
	INNER join CLIMBED
		on CLIMBED.trip_id = PARTICIPATED.trip_id
	GROUP BY sex
 ) AS c
 ON c.sex = CLIMBER.sex
GROUP BY climber.SEX

--- Question 12 ----
I have no idea

---- Question 13 ----
select region, max(ratio) as fraction from (SELECT PEAK.region, (c.peaksClimbed * 1.0)/(COUNT(PEAK.name) * 1.0) as ratio FROM PEAK
INNER JOIN (
	SELECT COUNT(DISTINCT CLIMBED.peak) as peaksClimbed, peak.region FROM PEAK
	INNER JOIN CLIMBED
		ON CLIMBED.PEAK = PEAK.NAME
	GROUP BY region
) as c
on c.region = PEAK.region
GROUP by PEAK.region)